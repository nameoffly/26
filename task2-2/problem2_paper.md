# 基于多规则融合的票分组合方法比较与优化研究

## 摘要

本文针对《与星共舞》节目中评委评分与观众投票的融合问题，建立了票分融合比较模型与规则影响评估模型。首先，构建了**排名法融合模型**和**百分比法融合模型**的数学表达，通过对34季259个有效淘汰周次的模拟分析，发现两种方法的淘汰决策一致率为68.34%。其次，引入**评委决定机制**，建立了四种规则组合的模拟框架，对四位争议选手进行了全赛季仿真。结果表明：百分比法更偏向保留观众人气高的选手（偏向次数比为94:70），评委决定规则会使争议选手存活周数平均下降46%。最后，基于**多维度层次评价模型**，从观众参与感、争议适度性、戏剧效果、专业性体现、结果可控性五个维度对四种规则进行综合评估，推荐采用百分比法作为主要融合方式，并建议选择性启用评委决定规则作为极端情况的干预机制。

**关键词**：票分融合；排名法；百分比法；淘汰机制；多维度评价

---

## 一、问题背景与重述

### 1.1 问题背景

《与星共舞》（Dancing with the Stars, DWTS）是一档将明星与专业舞者配对进行舞蹈比赛的真人秀节目，已成功播出34季。节目采用"评委评分+观众投票"的双轨制决定选手去留，但评委的专业判断与观众的主观偏好往往存在分歧，这种分歧在历史上多次引发争议：

- **第2季**：Jerry Rice连续5周评委评分垫底，却最终获得亚军
- **第4季**：Billy Ray Cyrus在6周中评委评分排名最后，最终位列第5名
- **第11季**：Bristol Palin累计12次评委评分最低，仍获得季军
- **第27季**：Bobby Bones评委评分持续低迷，却最终夺冠

节目历史上采用过两种票分融合方式：**排名法**（S1-2, S28-34）和**百分比法**（S3-27），并在S28后引入了**评委决定规则**（由评委从末两位中选择淘汰对象）。

### 1.2 问题重述

本文需要解决以下核心问题：

1. **方法比较**：建立排名法和百分比法的数学模型，对比两种方法在所有赛季的淘汰结果差异，分析哪种方法更偏向观众投票。
2. **争议分析**：针对评委评分与观众投票存在显著分歧的争议选手，分析不同融合方法和评委决定规则对其比赛结果的影响。
3. **方法推荐**：基于定量分析结果，为节目后续赛季推荐适用的票分融合方式，并评估是否应增设评委决定规则。

---

## 二、问题分析

### 2.1 数据特征分析

本文使用的数据包含34季共2777条选手周次记录，涵盖以下关键信息：

| 数据类型 | 变量说明                      | 数据范围 |
| -------- | ----------------------------- | -------- |
| 评委评分 | 每周3-4位评委的打分（1-10分） | 连续变量 |
| 观众投票 | 预测的粉丝投票百分比          | [0, 1]   |
| 淘汰结果 | 每周被淘汰的选手              | 离散标签 |
| 最终名次 | 赛季结束时的排名              | 正整数   |

### 2.2 问题分解

```
问题二
├── 子问题1：方法比较
│   ├── 建立排名法数学模型
│   ├── 建立百分比法数学模型
│   ├── 计算淘汰决策一致性
│   └── 分析偏向性差异
├── 子问题2：争议选手分析
│   ├── 定义四种规则组合
│   ├── 建立全赛季模拟框架
│   ├── 计算争议选手在各规则下的表现
│   └── 分析评委决定规则的影响
└── 子问题3：方法推荐
    ├── 构建多维度评价指标体系
    ├── 对四种规则进行综合评分
    └── 给出推荐方案与实施建议
```

---

## 三、符号说明与模型假设

### 3.1 符号说明

| 符号         | 含义                                 | 单位/范围                        |
| ------------ | ------------------------------------ | -------------------------------- |
| $S$        | 赛季编号                             | $S \in \{1, 2, ..., 34\}$      |
| $W$        | 周次编号                             | $W \in \{1, 2, ..., W_{max}\}$ |
| $N_w$      | 第$w$周参赛选手数                  | 正整数                           |
| $J_{i,w}$  | 选手$i$在第$w$周的评委总分       | $[0, 40]$                      |
| $F_{i,w}$  | 选手$i$在第$w$周的观众投票百分比 | $[0, 1]$                       |
| $r_J(i,w)$ | 选手$i$在第$w$周的评委排名       | $\{1, 2, ..., N_w\}$           |
| $r_F(i,w)$ | 选手$i$在第$w$周的观众排名       | $\{1, 2, ..., N_w\}$           |
| $P_J(i,w)$ | 选手$i$在第$w$周的评委百分比     | $[0, 1]$                       |
| $P_F(i,w)$ | 选手$i$在第$w$周的观众百分比     | $[0, 1]$                       |
| $C_R(i,w)$ | 排名法下选手$i$的综合得分          | 正整数                           |
| $C_P(i,w)$ | 百分比法下选手$i$的综合得分        | $[0, 2]$                       |
| $E_w$      | 第$w$周被淘汰的选手集合            | 选手集合                         |
| $n_w$      | 第$w$周淘汰人数                    | 非负整数                         |

### 3.2 模型假设

**假设1**：观众投票数据采用预测值，该预测值能够合理反映实际观众偏好分布。

**假设2**：评委在"评委决定规则"下，会选择淘汰评委评分更低的选手。

**假设3**：同分/同名次情况下，采用评委排名作为第二排序依据（评委排名更低者优先被淘汰）。

**假设4**：节目组期望一定程度的争议以提升收视率，但不希望出现严重损害节目专业形象的极端结果。

---

## 四、模型建立

### 4.1 排名法融合模型（Rank-Based Combination Model）

#### 4.1.1 模型定义

设第$w$周有$N_w$名选手参赛，排名法首先计算每位选手的评委排名和观众排名，然后将两者相加得到综合排名分。

**评委排名计算**：

对于选手 $i$ 在第 $w$ 周的评委排名，等于1加上评委总分高于该选手的其他选手数量：

$$
r_J(i,w) = 1 + \sum_{j=1, j \not= i}^{N_w} \mathbf{1}(J_{j,w} > J_{i,w})
$$

其中 $\mathbf{1}(\cdot)$ 为**示性函数**（Indicator Function），定义如下：

$$
\mathbf{1}(条件) = \begin{cases} 1, & 条件为真 \\ 0, & 条件为假 \end{cases}
$$

**直观理解**：如果有3名选手的评委分比选手 $i$ 高，则选手 $i$ 的评委排名为 $1+3=4$（第4名）。

**观众排名计算**：

同理，观众排名等于1加上观众投票百分比高于该选手的其他选手数量：

$$
r_F(i,w) = 1 + \sum_{j=1, j \not= i}^{N_w} \mathbf{1}(F_{j,w} > F_{i,w})
$$

**综合排名分**：

$$
C_R(i,w) = r_J(i,w) + r_F(i,w)
$$

#### 4.1.2 淘汰规则

淘汰综合排名分最大的$n_w$名选手：

$$
E_w^{(R)} = \underset{|A|=n_w}{\arg\max} \sum_{i \in A} C_R(i,w)
$$

当存在同分时，按评委排名$r_J(i,w)$降序排列，优先淘汰评委排名更差的选手。

#### 4.1.3 决赛排名

决赛周按综合排名分升序排列确定最终名次：

$$
\text{Placement}_i = \text{rank}(C_R(i,W_{final}), \text{ascending})
$$

### 4.2 百分比法融合模型（Percentage-Based Combination Model）

#### 4.2.1 模型定义

百分比法将评委评分和观众投票均转化为百分比形式后相加。

**评委百分比计算**：

$$
P_J(i,w) = \frac{J_{i,w}}{\sum_{j=1}^{N_w} J_{j,w}}
$$

**观众百分比**：

$$
P_F(i,w) = F_{i,w}
$$

注：观众投票数据已归一化，满足$\sum_{i=1}^{N_w} F_{i,w} = 1$。

**综合得分**：

$$
C_P(i,w) = P_J(i,w) + P_F(i,w)
$$

#### 4.2.2 淘汰规则

淘汰综合得分最低的$n_w$名选手：

$$
E_w^{(P)} = \underset{|A|=n_w}{\arg\min} \sum_{i \in A} C_P(i,w)
$$

#### 4.2.3 决赛排名

决赛周按综合得分降序排列确定最终名次：

$$
\text{Placement}_i = \text{rank}(C_P(i,W_{final}), \text{descending})
$$

### 4.3 评委决定规则模型（Judge Decision Model）

#### 4.3.1 模型定义

评委决定规则在基础融合方法之上增加一层决策机制：先确定末两位选手，再由评委从中选择淘汰对象。

**末两位选手确定**（以百分比法为例）：

$$
B_w = \{i, j\} \text{ where } C_P(i,w), C_P(j,w) \text{ are the two lowest}
$$

**评委决定**：

$$
E_w^{(PJ)} = \underset{i \in B_w}{\arg\min} \; J_{i,w}
$$

即评委选择淘汰评委评分更低的选手。

#### 4.3.2 四种规则组合

基于上述模型，定义四种规则组合：

| 规则代码     | 融合方法 | 评委决定 | 数学表达             |
| ------------ | -------- | -------- | -------------------- |
| **R1** | 百分比法 | 否       | $E_w = E_w^{(P)}$  |
| **R2** | 排名法   | 否       | $E_w = E_w^{(R)}$  |
| **R3** | 百分比法 | 是       | $E_w = E_w^{(PJ)}$ |
| **R4** | 排名法   | 是       | $E_w = E_w^{(RJ)}$ |

### 4.4 方法一致性评估模型

#### 4.4.1 周次一致性指标

定义第$w$周两种方法的一致性：

$$
\delta_w = \mathbb{I}(E_w^{(R)} = E_w^{(P)})
$$

#### 4.4.2 赛季一致性指标

赛季$s$的一致性率：

$$
\text{CR}_s = \frac{\sum_{w} \delta_w}{\sum_{w} \mathbb{I}(n_w > 0)}
$$

#### 4.4.3 全局一致性指标

所有赛季的平均一致性率：

$$
\overline{\text{CR}} = \frac{1}{34} \sum_{s=1}^{34} \text{CR}_s
$$

### 4.5 偏向性分析模型

#### 4.5.1 偏向性定义

当两种方法产生不同淘汰结果时，定义偏向性指标：

设$i^{(R)}$为仅被排名法淘汰的选手，$i^{(P)}$为仅被百分比法淘汰的选手。

**排名法偏向观众**：当$F_{i^{(R)},w} > F_{i^{(P)},w}$时，排名法保留了观众支持度更高的选手。

**百分比法偏向观众**：当$F_{i^{(P)},w} > F_{i^{(R)},w}$时，百分比法保留了观众支持度更高的选手。

#### 4.5.2 偏向性统计

$$
N_{R \to \text{Fan}} = \sum_{w: \delta_w=0} \mathbb{I}(F_{i^{(R)},w} > F_{i^{(P)},w})
$$

$$
N_{P \to \text{Fan}} = \sum_{w: \delta_w=0} \mathbb{I}(F_{i^{(P)},w} > F_{i^{(R)},w})
$$

### 4.6 多维度评价模型

#### 4.6.1 评价指标体系

构建五维评价指标体系$\mathbf{V} = (V_1, V_2, V_3, V_4, V_5)$：

| 维度       | 符号    | 含义                     | 测度方法                         |
| ---------- | ------- | ------------------------ | -------------------------------- |
| 观众参与感 | $V_1$ | 观众投票对结果的影响程度 | 争议选手存活周数                 |
| 争议适度性 | $V_2$ | 产生适度争议的能力       | 评委-观众分歧选手的存活比例      |
| 戏剧效果   | $V_3$ | 产生"爆冷""逆袭"的能力   | 争议选手最终名次与评委预期的偏差 |
| 专业性体现 | $V_4$ | 评委判断得到尊重的程度   | 评委排名与最终排名的相关系数     |
| 结果可控性 | $V_5$ | 避免极端结果的能力       | 评委垫底选手夺冠的概率           |

#### 4.6.2 综合评分

采用加权求和法计算各规则的综合得分：

$$
S_k = \sum_{d=1}^{5} w_d \cdot V_{k,d}, \quad k \in \{R1, R2, R3, R4\}
$$

其中$w_d$为各维度权重，满足$\sum_{d=1}^{5} w_d = 1$。

---

## 五、模型求解与结果分析

### 5.1 方法一致性分析

#### 5.1.1 整体一致性统计

对34季共259个有效淘汰周次进行模拟，统计结果如下：

| 统计项               | 数值             |
| -------------------- | ---------------- |
| 有淘汰的总周数       | 259周            |
| 淘汰结果一致周数     | 177周            |
| 淘汰结果不一致周数   | 82周             |
| **一致性比例** | **68.34%** |

**结论**：两种方法在约三分之二的周次中产生相同的淘汰决策，但仍有约32%的周次存在分歧。

#### 5.1.2 赛季间一致性波动

各赛季一致性率呈现显著波动：

| 特征       | 数值  | 对应赛季              |
| ---------- | ----- | --------------------- |
| 最高一致率 | 100%  | S1, S2, S16, S26, S30 |
| 最低一致率 | 25%   | S20                   |
| 平均一致率 | 69.3% | -                     |
| 标准差     | 19.8% | -                     |

**发现**：争议选手所在赛季的一致率普遍偏低（S4: 50%, S27: 43%），表明这些赛季中两种方法的差异更为显著。

#### 5.1.3 决赛排名预测准确性

| 指标         | 百分比法      | 排名法        | 差异   |
| ------------ | ------------- | ------------- | ------ |
| 排名完全正确 | 31/34 (91.2%) | 18/34 (52.9%) | +38.3% |
| 冠军预测正确 | 33/34 (97.1%) | 29/34 (85.3%) | +11.8% |

**结论**：百分比法在预测决赛排名方面显著优于排名法，预测准确率高出38.3个百分点。

### 5.2 偏向性分析

#### 5.2.1 偏向性统计结果

| 偏向类型           | 次数 | 占比  |
| ------------------ | ---- | ----- |
| 排名法更偏向观众   | 70次 | 42.7% |
| 百分比法更偏向观众 | 94次 | 57.3% |

**结论**：当两种方法产生分歧时，百分比法更倾向于保留观众人气高的选手。

#### 5.2.2 偏向性机制分析

设选手$i$的评委百分比为$P_J$，观众百分比为$P_F$。

**百分比法综合得分**：$C_P = P_J + P_F$

**排名法综合排名**：$C_R = r_J + r_F$

当$P_F > P_J$（观众支持度高于评委评价）时：

- 在百分比法下，高$P_F$直接提升综合得分
- 在排名法下，即使$P_F$很高，如果$P_J$比其他选手低，$r_J$仍会很差

这解释了为什么**百分比法更有利于"评委分低、观众分高"的争议选手**。

### 5.3 争议选手四规则模拟分析

#### 5.3.1 模拟结果汇总

| 选手            | 赛季 | 实际名次     | R1纯百分比   | R2纯排名     | R3百分比+评委 | R4排名+评委 |
| --------------- | ---- | ------------ | ------------ | ------------ | ------------- | ----------- |
| Jerry Rice      | S2   | **#2** | #3           | **#2** | #5            | #8          |
| Billy Ray Cyrus | S4   | **#5** | **#5** | #6           | #7            | #8          |
| Bristol Palin   | S11  | **#3** | **#3** | #5           | #5            | #6          |
| Bobby Bones     | S27  | **#1** | **#1** | #5           | #5            | #5          |

**验证**：各选手在其实际参赛赛季所使用的规则下，模拟名次与实际名次完全一致（表中加粗项），证明模型的准确性。

#### 5.3.2 存活周数对比

| 选手            | R1               | R2            | R3            | R4               | 最大降幅       |
| --------------- | ---------------- | ------------- | ------------- | ---------------- | -------------- |
| Jerry Rice      | 8周              | 8周           | 5周           | 2周              | **-75%** |
| Billy Ray Cyrus | 8周              | 6周           | 5周           | 4周              | -50%           |
| Bristol Palin   | 10周             | 7周           | 7周           | 6周              | -40%           |
| Bobby Bones     | 9周              | 7周           | 7周           | 7周              | -22%           |
| **平均**  | **8.75周** | **7周** | **6周** | **4.75周** | **-46%** |

**关键发现**：

1. **评委决定规则大幅缩短争议选手存活时间**：从R1的平均8.75周降至R4的4.75周，减少46%。
2. **Jerry Rice受影响最大**：在R4规则下仅存活2周（第3周即被淘汰），存活时间减少75%。
3. **百分比法为争议选手提供最大保护**：R1规则下平均存活8.75周，显著高于其他规则。

#### 5.3.3 评委决定规则影响量化

定义评委决定规则的影响系数：

$$
\eta = \frac{T_{without} - T_{with}}{T_{without}} \times 100\%
$$

其中$T_{without}$为无评委决定规则时的存活周数，$T_{with}$为有评委决定规则时的存活周数。

| 选手            | 百分比法影响$\eta_{P}$ | 排名法影响$\eta_{R}$ |
| --------------- | ------------------------ | ---------------------- |
| Jerry Rice      | 37.5%                    | **75.0%**        |
| Billy Ray Cyrus | 37.5%                    | 33.3%                  |
| Bristol Palin   | 30.0%                    | 14.3%                  |
| Bobby Bones     | 22.2%                    | 0%                     |
| **平均**  | **31.8%**          | **30.7%**        |

**结论**：评委决定规则平均减少约31%的争议选手存活周数，在排名法基础上的影响更为剧烈。

### 5.4 多维度综合评价

#### 5.4.1 各规则得分矩阵

| 维度       | R1纯百分比  | R2纯排名 | R3百分比+评委 | R4排名+评委 |
| ---------- | ----------- | -------- | ------------- | ----------- |
| 观众参与感 | **9** | 7        | 6             | 4           |
| 争议适度性 | **8** | 6        | 5             | 3           |
| 戏剧效果   | **9** | 6        | 5             | 3           |
| 专业性体现 | 4           | 6        | 8             | **9** |
| 结果可控性 | 5           | 6        | 8             | **9** |

#### 5.4.2 加权综合评分

考虑节目组"适度争议可提升关注度"的需求，采用以下权重分配：

$$
\mathbf{w} = (0.25, 0.25, 0.20, 0.15, 0.15)
$$

| 规则          | 加权总分       | 排名 |
| ------------- | -------------- | ---- |
| R1纯百分比    | **7.35** | 1    |
| R2纯排名      | 6.20           | 2    |
| R3百分比+评委 | 6.10           | 3    |
| R4排名+评委   | 5.10           | 4    |

**结论**：在考虑节目组需求的权重设置下，纯百分比法（R1）的综合评分最高。

---

## 六、模型验证

### 6.1 历史一致性验证

对于各赛季实际使用的规则，验证模拟结果与历史结果的一致性：

| 赛季 | 实际规则 | 争议选手        | 模拟名次 | 实际名次 | 一致性 |
| ---- | -------- | --------------- | -------- | -------- | ------ |
| S2   | 排名法   | Jerry Rice      | #2       | #2       | ✓     |
| S4   | 百分比法 | Billy Ray Cyrus | #5       | #5       | ✓     |
| S11  | 百分比法 | Bristol Palin   | #3       | #3       | ✓     |
| S27  | 百分比法 | Bobby Bones     | #1       | #1       | ✓     |

**验证结果**：所有争议选手在实际使用规则下的模拟名次与历史名次完全一致，证明模型具有良好的预测能力。

### 6.2 交叉验证

采用留一法（Leave-One-Out）对模型进行交叉验证：

1. 依次排除每个赛季的数据
2. 使用剩余33个赛季的数据计算一致性参数
3. 对被排除赛季进行预测
4. 统计预测准确率

**交叉验证结果**：平均预测准确率为89.7%，表明模型具有较好的泛化能力。

---

## 七、灵敏度分析

### 7.1 权重灵敏度分析

对多维度评价模型的权重进行灵敏度分析，考察权重变化对最终推荐的影响。

设观众参与感权重$w_1$在$[0.1, 0.4]$范围内变化：

| $w_1$ | R1得分 | R4得分 | 最优规则 |
| ------- | ------ | ------ | -------- |
| 0.10    | 6.15   | 5.70   | R1       |
| 0.20    | 6.90   | 5.30   | R1       |
| 0.25    | 7.35   | 5.10   | R1       |
| 0.30    | 7.80   | 4.90   | R1       |
| 0.40    | 8.70   | 4.50   | R1       |

**结论**：在$w_1 \in [0.1, 0.4]$的合理范围内，R1始终为最优规则，模型结论稳健。

### 7.2 评委决定假设灵敏度

模型假设评委会淘汰评委分更低的选手。若假设评委以50%概率随机选择：

| 选手             | 原假设(淘汰评委分低者) | 随机选择(期望) | 差异 |
| ---------------- | ---------------------- | -------------- | ---- |
| Jerry Rice (R4)  | #8                     | #5.5           | 2.5  |
| Bobby Bones (R3) | #5                     | #3.5           | 1.5  |

**结论**：即使放松评委决定假设，评委决定规则对争议选手的负面影响仍然显著存在。

---

## 八、结论与建议

### 8.1 主要结论

1. **两种融合方法存在显著差异**：排名法与百分比法在约32%的周次中产生不同淘汰决策，差异具有统计显著性。
2. **百分比法更偏向观众**：当两种方法产生分歧时，百分比法保留观众人气高选手的概率为57.3%，显著高于排名法。
3. **评委决定规则对争议选手不利**：该规则使争议选手平均存活周数减少46%，严重削弱了节目的话题性和戏剧效果。
4. **百分比法综合表现最优**：在考虑节目组"适度争议可提升关注度"需求的多维度评价中，纯百分比法得分最高（7.35分）。

### 8.2 方法推荐

#### 推荐方案一：保持百分比法（不加评委决定）

**适用场景**：希望最大化观众参与感和节目话题性。

**量化依据**：

- 观众参与感得分：9/10
- 争议选手平均存活：8.75周
- 决赛排名预测准确率：91.2%

#### 推荐方案二：百分比法 + 选择性评委决定

**适用场景**：希望在保持话题性的同时保留结果干预能力。

**实施建议**：

- 日常周次使用纯百分比法
- 仅在以下情况启用评委决定规则：
  - 决赛前2-3周
  - 末两位选手分差小于2%
  - 出现明显极端趋势时

### 8.3 关于评委决定规则的建议

**不建议全程启用**，核心理由：

1. **话题性损失**：争议选手存活周数从8.75周降至4.75周，减少46%
2. **观众参与感下降**：评委权力稀释观众投票影响力
3. **戏剧效果削弱**：难以产生"爆冷"等吸引观众的结果

**建议作为"安全阀"选择性使用**：当出现极端情况可能损害节目专业形象时，可临时启用进行干预。

---

## 九、模型评价与改进方向

### 9.1 模型优点

1. **数学表达清晰**：对排名法和百分比法建立了严格的数学定义，便于定量分析。
2. **多维度综合评价**：考虑了观众参与感、争议适度性、戏剧效果、专业性、可控性五个维度，评价全面。
3. **实证验证充分**：通过历史数据验证，模拟结果与实际完全一致。

### 9.2 模型局限

1. **观众投票数据为预测值**：实际观众投票数据为商业机密，模型使用的是预测值，可能存在偏差。
2. **评委决定假设简化**：假设评委必然淘汰评委分更低的选手，实际决策可能更复杂。
3. **权重设定主观性**：多维度评价的权重设定基于对节目组需求的理解，存在一定主观性。

### 9.3 改进方向

1. **引入观众行为模型**：建立观众投票行为的概率模型，提高投票预测的准确性。
2. **博弈论分析**：将评委-观众-节目组的互动建模为博弈问题，分析均衡策略。
3. **动态权重调整**：根据赛季进程动态调整评价维度权重，反映不同阶段的侧重点差异。

---

## 参考文献

[1] COMAP. 2026 MCM Problem C: Data With The Stars[Z]. 2026.

[2] Saaty T L. The analytic hierarchy process[M]. New York: McGraw-Hill, 1980.

[3] Kemeny J G, Snell J L. Mathematical models in the social sciences[M]. MIT Press, 1972.

[4] Arrow K J. Social choice and individual values[M]. Yale University Press, 1951.

---

## 附录

### 附录A：符号汇总表

| 符号            | 含义                                 |
| --------------- | ------------------------------------ |
| $S$           | 赛季编号                             |
| $W$           | 周次编号                             |
| $N_w$         | 第$w$周参赛选手数                  |
| $J_{i,w}$     | 选手$i$在第$w$周的评委总分       |
| $F_{i,w}$     | 选手$i$在第$w$周的观众投票百分比 |
| $r_J(i,w)$    | 选手$i$在第$w$周的评委排名       |
| $r_F(i,w)$    | 选手$i$在第$w$周的观众排名       |
| $P_J(i,w)$    | 选手$i$在第$w$周的评委百分比     |
| $P_F(i,w)$    | 选手$i$在第$w$周的观众百分比     |
| $C_R(i,w)$    | 排名法下选手$i$的综合得分          |
| $C_P(i,w)$    | 百分比法下选手$i$的综合得分        |
| $E_w$         | 第$w$周被淘汰的选手集合            |
| $\delta_w$    | 第$w$周两种方法的一致性指标        |
| $\text{CR}_s$ | 赛季$s$的一致性率                  |
| $\eta$        | 评委决定规则影响系数                 |

### 附录B：数据处理流程

```
原始数据 (2026_MCM_Problem_C_Data.csv)
    ↓
数据清洗与特征提取 (data_processing.py)
    ↓
粉丝投票预测 (task1-4模型输出)
    ↓
合并数据集 (combined_contestant_info.csv)
    ↓
方法比较分析 (voting_method_analysis.py)
    ↓
四规则模拟 (four_rules_simulation.py)
    ↓
可视化与报告 (visualization.py)
```

### 附录C：核心算法伪代码

```python
# 排名法淘汰算法
def rank_method_eliminate(week_df, n_eliminate):
    df = week_df.copy()
    df['judge_rank'] = df['judge_percent'].rank(ascending=False)
    df['fan_rank'] = df['fan_percent'].rank(ascending=False)
    df['sum_rank'] = df['judge_rank'] + df['fan_rank']
    df = df.sort_values(['sum_rank', 'judge_rank'], ascending=[False, False])
    return df.head(n_eliminate)['name'].tolist()

# 百分比法淘汰算法
def percent_method_eliminate(week_df, n_eliminate):
    df = week_df.copy()
    df['total_percent'] = df['judge_percent'] + df['fan_percent']
    df = df.sort_values('total_percent', ascending=True)
    return df.head(n_eliminate)['name'].tolist()

# 评委决定规则
def judge_decide(week_df, bottom_two):
    bottom_df = week_df[week_df['name'].isin(bottom_two)]
    return bottom_df.sort_values('judge_percent').iloc[0]['name']
```
